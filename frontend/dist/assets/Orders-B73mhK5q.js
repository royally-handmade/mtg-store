import{N as st,Q as nt,G as lt,r as p,n as ot,o as at,a as it,c as i,b as a,d as t,q as rt,v as dt,s as ct,f as P,t as l,w as E,h as _,F as L,j as Q,e as r,L as z,g as ut,m as I}from"./index-D5lSLxc0.js";import{T as gt}from"./TreatmentBadge-a7nld0Nr.js";const pt={class:"space-y-6"},_t={class:"flex justify-between items-center"},xt={class:"flex space-x-4"},bt={key:0,class:"flex justify-center items-center py-12"},mt={key:1,class:"text-center py-12"},yt={class:"text-gray-500 text-lg mb-4"},vt={key:2,class:"space-y-6"},ht={class:"p-6 border-b border-gray-200"},ft={class:"flex justify-between items-start"},wt={class:"text-lg font-semibold text-gray-900"},Ct={class:"text-sm text-gray-500 mt-1"},kt={class:"text-right"},St={class:"text-lg font-bold text-gray-900"},Dt={class:"p-6"},At={class:"space-y-4"},$t={class:"flex flex-col gap-2 p-1"},Nt=["src","alt"],jt={class:"flex-1"},Ot={class:"flex gap-3 p-1"},Tt={class:"font-medium text-gray-900"},Ft={class:"flex gap-3 p-1"},Bt={class:"flex gap-3"},Ut={class:"text-sm text-gray-600"},Vt={class:"text-sm text-gray-600"},qt={class:"text-sm text-gray-600 mt-1"},Mt={class:"flex items-center space-x-4 mt-2"},Pt={class:"text-sm text-gray-600"},Et={class:"text-sm font-medium text-gray-900"},Lt={class:"text-right"},Qt={class:"text-lg font-semibold text-gray-900"},zt={class:"px-6 pb-6"},It={class:"bg-gray-50 rounded-lg p-4"},Rt={class:"flex justify-between text-sm text-gray-600 mb-2"},Gt={class:"flex justify-between text-sm text-gray-600 mb-2"},Ht={class:"flex justify-between text-sm text-gray-600 mb-2"},Jt={class:"border-t border-gray-200 pt-2 mt-2"},Kt={class:"flex justify-between text-lg font-semibold text-gray-900"},Wt={class:"flex"},Xt={key:0,class:"px-6 pb-6 grow"},Yt={class:"text-sm text-gray-600 bg-gray-50 p-4 rounded-lg"},Zt={key:0},te={key:1,class:"px-6 pb-6 grow"},ee={class:"text-sm text-gray-600 bg-gray-50 p-4 rounded-lg"},se={key:0},ne={key:0,class:"px-6 pb-6"},le={class:"text-sm bg-blue-50 p-4 rounded-lg"},oe={class:"text-blue-900"},ae={class:"font-mono"},ie={class:"px-6 pb-6 flex justify-between items-center"},re={class:"text-sm text-gray-500"},de={class:"flex space-x-3"},ce=["onClick","disabled"],ue=["onClick"],ge=["onClick"],be={__name:"Orders",setup(pe){const R=st(),G=nt(),d=lt(),x=p([]),b=p(!0),c=p(""),g=p(null),m=ot(()=>c.value?x.value.filter(n=>n.status===c.value):x.value),y=async()=>{try{b.value=!0;const n=await I.get("/orders");x.value=n.data}catch(n){console.error("Error fetching orders:",n),d.error("Failed to load orders")}finally{b.value=!1}},H=()=>{},v=n=>new Date(n).toLocaleDateString("en-CA",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),J=n=>({pending:"Pending",processing:"Processing",shipped:"Shipped",delivered:"Delivered",cancelled:"Cancelled"})[n]||n,K=n=>n?(n=n.replace("_"," "),n.replace(/(^|\s)[a-z]/gi,e=>e.toUpperCase())):"Unknown",W=n=>({near_mint:"bg-green-100 text-green-800",nm:"bg-green-100 text-green-800",lightly_played:"bg-blue-100 text-blue-800",moderately_played:"bg-yellow-100 text-yellow-800",heavily_played:"bg-orange-100 text-orange-800",damaged:"bg-red-100 text-red-800"})[n]||"bg-gray-100 text-gray-800",X=n=>({pending:"bg-yellow-100 text-yellow-800",processing:"bg-blue-100 text-blue-800",shipped:"bg-purple-100 text-purple-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"})[n]||"bg-gray-100 text-gray-800",h=n=>!n||!Array.isArray(n)?"0.00":n.reduce((e,u)=>e+u.price*u.quantity,0).toFixed(2),Y=n=>((typeof n=="string"?parseFloat(n):n)*.13).toFixed(2),Z=async n=>{try{g.value=n,await I.post(`/orders/${n}/cancel`),d.success("Order cancelled successfully"),await y()}catch(e){console.error("Error cancelling order:",e),d.error("Failed to cancel order")}finally{g.value=null}},tt=async n=>{try{for(const e of n.order_items)e.listings&&e.listings.status==="active"&&await G.addToCart(e.listings.id,e.quantity);d.success("Items added to cart"),R.push("/cart")}catch(e){console.error("Error reordering items:",e),d.error("Some items may no longer be available")}},et=n=>{n&&n.email?window.location.href=`mailto:${n.email}?subject=Question about my order`:d.error("Seller contact information not available")};return at(y),(n,e)=>{const u=it("router-link");return a(),i("div",pt,[t("div",_t,[e[2]||(e[2]=t("h1",{class:"text-3xl font-bold"},"My Orders",-1)),t("div",xt,[rt(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),onChange:H,class:"rounded border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[1]||(e[1]=[ct('<option value="">All Orders</option><option value="pending">Pending</option><option value="processing">Processing</option><option value="shipped">Shipped</option><option value="delivered">Delivered</option><option value="cancelled">Cancelled</option>',6)])],544),[[dt,c.value]])])]),b.value?(a(),i("div",bt,[...e[3]||(e[3]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)])])):m.value.length===0?(a(),i("div",mt,[t("div",yt,l(c.value?`No ${c.value} orders found`:"No orders found"),1),P(u,{to:"/cards",class:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors"},{default:E(()=>[...e[4]||(e[4]=[_(" Start Shopping ",-1)])]),_:1})])):(a(),i("div",vt,[(a(!0),i(L,null,Q(m.value.orders,s=>(a(),i("div",{key:s.id,class:"bg-white rounded-lg shadow border hover:shadow-md transition-shadow"},[t("div",ht,[t("div",ft,[t("div",null,[t("h3",wt," Order #"+l(s.id.slice(0,8)),1),t("p",Ct," Placed on "+l(v(s.created_at)),1)]),t("div",kt,[t("div",St," $"+l(s.total_amount)+" CAD ",1),t("span",{class:z([X(s.status),"inline-flex px-3 py-1 text-xs font-semibold rounded-full mt-2"])},l(J(s.status)),3)])])]),t("div",Dt,[e[6]||(e[6]=t("h4",{class:"font-medium text-gray-900 mb-4"},"Order Items",-1)),t("div",At,[(a(!0),i(L,null,Q(s.order_items,o=>{var f,w,C,k,S,D,A,$,N,j,O,T,F,B,U,V,q;return a(),i("div",{key:o.id,class:"flex items-center space-x-4 p-4 bg-gray-50 rounded-lg"},[t("div",$t,[t("img",{src:(w=(f=o.listings)==null?void 0:f.cards)==null?void 0:w.image_url,alt:(k=(C=o.listings)==null?void 0:C.cards)==null?void 0:k.name,class:"w-16 h-22 object-cover shadow-sm"},null,8,Nt)]),t("div",jt,[t("div",Ot,[t("h5",Tt,l(((D=(S=o.listings)==null?void 0:S.cards)==null?void 0:D.name)||"Unknown Card"),1),t("span",{class:z(["px-2 py-1 rounded text-xs font-medium",W((A=o.listings)==null?void 0:A.condition)])},l(K(($=o.listings)==null?void 0:$.condition)),3)]),t("div",Ft,[(j=(N=o.listings)==null?void 0:N.cards)!=null&&j.treatment?(a(),ut(gt,{key:0,treatment:(T=(O=o.listings)==null?void 0:O.cards)==null?void 0:T.treatment},null,8,["treatment"])):r("",!0)]),t("div",Bt,[t("p",Ut," Set: "+l(((B=(F=o.listings)==null?void 0:F.cards)==null?void 0:B.set_number)||"Unknown"),1),t("p",Vt," Card No: "+l((V=(U=o.listings)==null?void 0:U.cards)==null?void 0:V.card_number),1)]),t("p",qt,[e[5]||(e[5]=_(" Seller: ",-1)),P(u,{to:"/seller/"+((q=o.listings)==null?void 0:q.seller.id),class:"text-blue-600 hover:text-blue-800"},{default:E(()=>{var M;return[_(l(((M=o.listings)==null?void 0:M.seller.display_name)||"Unknown Seller"),1)]}),_:2},1032,["to"])]),t("div",Mt,[t("span",Pt," Quantity: "+l(o.quantity),1),t("span",Et," $"+l(o.price)+" CAD each ",1)])]),t("div",Lt,[t("div",Qt," $"+l((o.price*o.quantity).toFixed(2))+" CAD ",1)])])}),128))])]),t("div",zt,[t("div",It,[t("div",Rt,[e[7]||(e[7]=t("span",null,"Subtotal:",-1)),t("span",null,"$"+l(s.subtotal||h(s.order_items))+" CAD",1)]),t("div",Gt,[e[8]||(e[8]=t("span",null,"Shipping:",-1)),t("span",null,"$"+l(s.shipping_cost||"5.00")+" CAD",1)]),t("div",Ht,[e[9]||(e[9]=t("span",null,"Tax:",-1)),t("span",null,"$"+l(s.tax_amount||Y(s.subtotal||h(s.order_items)))+" CAD",1)]),t("div",Jt,[t("div",Kt,[e[10]||(e[10]=t("span",null,"Total:",-1)),t("span",null,"$"+l(s.total_amount)+" CAD",1)])])])]),t("div",Wt,[s.shipping_address?(a(),i("div",Xt,[e[11]||(e[11]=t("h4",{class:"font-medium text-gray-900 mb-2"},"Shipping Address",-1)),t("div",Yt,[t("div",null,l(s.shipping_address.name),1),t("div",null,l(s.shipping_address.street1),1),s.shipping_address.street2?(a(),i("div",Zt,l(s.shipping_address.street2),1)):r("",!0),t("div",null,l(s.shipping_address.city)+", "+l(s.shipping_address.province)+" "+l(s.shipping_address.postalCode),1),t("div",null,l(s.shipping_address.country),1)])])):r("",!0),s.billing_address?(a(),i("div",te,[e[12]||(e[12]=t("h4",{class:"font-medium text-gray-900 mb-2"},"Billing Address",-1)),t("div",ee,[t("div",null,l(s.billing_address.name),1),t("div",null,l(s.billing_address.street1),1),s.billing_address.street2?(a(),i("div",se,l(s.billing_address.street2),1)):r("",!0),t("div",null,l(s.billing_address.city)+", "+l(s.billing_address.province)+" "+l(s.billing_address.postalCode),1),t("div",null,l(s.billing_address.country),1)])])):r("",!0)]),s.tracking_number?(a(),i("div",ne,[e[14]||(e[14]=t("h4",{class:"font-medium text-gray-900 mb-2"},"Tracking Information",-1)),t("div",le,[t("div",oe,[e[13]||(e[13]=_(" Tracking Number: ",-1)),t("span",ae,l(s.tracking_number),1)])])])):r("",!0),t("div",ie,[t("div",re," Last updated: "+l(v(s.updated_at)),1),t("div",de,[s.status==="pending"?(a(),i("button",{key:0,onClick:o=>Z(s.id),disabled:g.value===s.id,class:"px-4 py-2 text-sm border border-red-300 text-red-700 rounded-lg hover:bg-red-50 disabled:opacity-50"},l(g.value===s.id?"Cancelling...":"Cancel Order"),9,ce)):r("",!0),t("button",{onClick:o=>tt(s),class:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Reorder Items ",8,ue),t("button",{onClick:o=>et(s.seller),class:"px-4 py-2 text-sm border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"}," Contact Seller ",8,ge)])])]))),128))]))])}}};export{be as default};
