import{N as U,P as C,u as E,G as T,r as n,c as o,b as r,d as e,e as i,t as m,I as k,q as c,J as g,v as B,f as S,i as h}from"./index-D5lSLxc0.js";import{r as D}from"./CheckCircleIcon-CPskrV3K.js";import{r as I}from"./ExclamationTriangleIcon-qqwZ6LDi.js";const M={class:"max-w-md mx-auto bg-white rounded-lg shadow-lg p-8"},F={class:"text-center mb-8"},G={class:"text-3xl font-bold"},J={class:"text-gray-600 mt-2"},L={key:0},W={key:1},$={key:0,class:"text-sm text-gray-500 mt-1"},Y=["disabled"],j=["disabled"],z={class:"mt-6 text-center space-y-2"},H={key:0},K={key:2,class:"mt-4 p-3 bg-green-100 border border-green-300 rounded text-green-700"},O={class:"flex items-center"},Q={key:3,class:"mt-4 p-3 bg-red-100 border border-red-300 rounded text-red-700"},X={class:"flex items-center"},le={__name:"Auth",setup(Z){const _=U(),P=C(),x=E(),w=T(),a=n(!1),u=n(!1),p=n(!1),y=n(!1),b=n(!1),d=n(""),f=n(""),s=n({email:"",password:"",displayName:"",role:"buyer"}),A=()=>u.value?"Reset Password":a.value?"Create Account":"Sign In",N=()=>u.value?"Enter your email to receive a reset link":a.value?"Join the MTG community":"Welcome back!",V=async()=>{p.value=!0,d.value="";try{if(a.value)await x.signUp(s.value.email,s.value.password,{display_name:s.value.displayName,role:s.value.role}),w.success("Account created successfully!");else{await x.signIn(s.value.email,s.value.password);const v=P.query.redirect||"/dashboard";_.push(v)}}catch(v){d.value=v.message||"An error occurred"}finally{p.value=!1}},q=async()=>{y.value=!0,d.value="",b.value=!1;try{await x.resetPassword(f.value),b.value=!0,w.success("Password reset link sent to your email!")}catch(v){d.value=v.message||"Failed to send reset email"}finally{y.value=!1}},R=()=>{u.value=!u.value,d.value="",b.value=!1,f.value=""};return(v,t)=>(r(),o("div",M,[e("div",F,[e("h1",G,m(A()),1),e("p",J,m(N()),1)]),u.value?i("",!0):(r(),o("form",{key:0,onSubmit:k(V,["prevent"]),class:"space-y-6"},[a.value?(r(),o("div",L,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Display Name",-1)),c(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.displayName=l),type:"text",required:"",class:"input-field",placeholder:"Your display name"},null,512),[[g,s.value.displayName]])])):i("",!0),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email",-1)),c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.email=l),type:"email",required:"",class:"input-field",placeholder:"your@email.com"},null,512),[[g,s.value.email]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Password",-1)),c(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.password=l),type:"password",required:"",class:"input-field",placeholder:"••••••••"},null,512),[[g,s.value.password]])]),a.value?(r(),o("div",W,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Account Type",-1)),c(e("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.role=l),class:"input-field"},[...t[9]||(t[9]=[e("option",{value:"buyer"},"Buyer",-1),e("option",{value:"seller"},"Seller",-1)])],512),[[B,s.value.role]]),s.value.role==="seller"?(r(),o("p",$," Seller accounts require approval before you can list items. ")):i("",!0)])):i("",!0),e("button",{type:"submit",disabled:p.value,class:"w-full btn-primary disabled:opacity-50"},m(p.value?"Please wait...":a.value?"Create Account":"Sign In"),9,Y)],32)),u.value?(r(),o("form",{key:1,onSubmit:k(q,["prevent"]),class:"space-y-6"},[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email Address",-1)),c(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>f.value=l),type:"email",required:"",class:"input-field",placeholder:"Enter your email address"},null,512),[[g,f.value]]),t[12]||(t[12]=e("p",{class:"text-sm text-gray-500 mt-1"}," We'll send you a link to reset your password. ",-1))]),e("button",{type:"submit",disabled:y.value,class:"w-full btn-primary disabled:opacity-50"},m(y.value?"Sending...":"Send Reset Link"),9,j)],32)):i("",!0),e("div",z,[u.value?i("",!0):(r(),o("div",H,[e("button",{onClick:t[5]||(t[5]=l=>a.value=!a.value),class:"text-blue-600 hover:text-blue-800"},m(a.value?"Already have an account? Sign in":"Don't have an account? Sign up"),1)])),e("div",null,[e("button",{onClick:R,class:"text-sm text-gray-600 hover:text-gray-800"},m(u.value?"Back to sign in":"Forgot your password?"),1)])]),b.value?(r(),o("div",K,[e("div",O,[S(h(D),{class:"h-5 w-5 mr-2"}),t[13]||(t[13]=e("span",null,"Password reset link sent! Check your email.",-1))])])):i("",!0),d.value?(r(),o("div",Q,[e("div",X,[S(h(I),{class:"h-5 w-5 mr-2"}),e("span",null,m(d.value),1)])])):i("",!0)]))}};export{le as default};
